{% load wagtailimages_tags %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Ensure Swiper JS and CSS are linked correctly -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      .swiper-pagination-bullet {
        background-color: #d1d5db;
      }

      .swiper-pagination-bullet-active {
        background-color: #ef4444;
      }

      .swiper-button-prev,
      .swiper-button-next {
        background-color: transparent;
        color: #ef4444;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background-color 0.3s ease, transform 0.3s ease;
        z-index: 10;
        visibility: visible;
      }

      .swiper-button-prev:hover,
      .swiper-button-next:hover {
        background-color: #ef4444;
        width: 55px;
        height: 55px;
        color: white !important;
      }

      .swiper-button-prev svg,
      .swiper-button-next svg {
        width: 20px;
        height: 20px;
      }

      .swiper-slide {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .swiper-slide:hover {
        transform: translateY(-10px);
        box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1),
          0 4px 6px rgba(0, 0, 0, 0.05);
      }

      .swiper-container-animation {
        opacity: 0;
        transform: translateX(50px);
        transition: opacity 0.8s ease, transform 0.8s ease;
      }

      .swiper-container-animate-in {
        opacity: 1;
        transform: translateX(0);
      }

      .custom-shadow {
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
        transition: box-shadow 0.3s ease-in-out, border 0.3s ease-in-out;
      }

      .custom-shadow:hover {
        box-shadow: 0px 4px 10px rgba(153, 27, 27, 0.3);
        border: 3px solid rgba(153, 27, 27, 0.6);
      }
    </style>
  </head>

  <body class="bg-gray-100">
    <div class="container mx-auto px-4 sm:px-6 md:px-8 lg:px-10 xl:px-16 py-12">
      <!-- Swiper Container with animation -->
      <div class="relative swiper-container-animation" id="swiper-container">
        <div class="swiper mySwiper">
          <div class="swiper-wrapper">
            {% for blog in blogs %}
            <a
              href="{{ blog.url }}"
              class="swiper-slide bg-white custom-shadow m-3 p-3 space-y-4 max-w-[380px] sm:max-w-[350px] md:max-w-[400px] lg:max-w-[450px]"
            >
              <!-- Blog card width increased -->
              {% image blog.blog_cover_image width-400 as blog_cover %}
              <img
                src="{{ blog_cover.url }}"
                alt="Blog Image"
                class="w-full h-48 rounded-lg object-cover"
              />
              <h3 class="text-xl font-bold">
                {{ blog.blog_title | truncatewords:5 }}
              </h3>
              <p class="text-gray-500">
                {{ blog.blog_description | truncatewords:6 }}
              </p>
              {% if blog.categories.all %}
              <div class="flex gap-4 mt-2">
                {% for category in blog.categories.all %}
                <span class="px-2 py-1 bg-red-100 text-red-500 rounded"
                  >{{ category.name }}</span
                >
                {% endfor %}
              </div>
              {% endif %}
            </a>
            {% endfor %}
          </div>
          <div class="mt-16">
            <!-- Pagination -->
            <div class="swiper-pagination"></div>
          </div>
        </div>

        <!-- Navigation Arrows -->
        <div
          class="swiper-button-prev absolute top-1/2 left-2 sm:left-4 md:left-6 transform -translate-y-1/2 z-10"
        ></div>
        <div
          class="swiper-button-next absolute top-1/2 right-4 sm:right-[100px] md:right-4 transform -translate-y-1/2 z-10 block"
        ></div>
      </div>
    </div>

    <script>
      let mySwiperInstance;

      // Initialize swiper once the DOM is loaded
      window.addEventListener("load", function () {
        if (!mySwiperInstance) {
          console.log("Initializing Swiper..."); // Log initialization
          mySwiperInstance = new Swiper(".mySwiper", {
            slidesPerView: 1, // Show 1 slide on mobile
            spaceBetween: 30,
            loop: true,
            simulateTouch: true,
            touchRatio: 1,
            pagination: {
              el: ".swiper-pagination",
              clickable: true,
            },
            navigation: {
              nextEl: ".swiper-button-next",
              prevEl: ".swiper-button-prev",
            },
            breakpoints: {
              1280: {
                slidesPerView: 4,
                spaceBetween: 30,
              },
              1024: {
                slidesPerView: 3,
                spaceBetween: 25,
              },
              768: {
                slidesPerView: 2,
                spaceBetween: 20,
              },
              640: {
                slidesPerView: 1, // 1 slide, but larger than before
                spaceBetween: 20,
              },
            },
          });
          console.log("Swiper Initialized:", mySwiperInstance);
        }

        const swiperContainer = document.getElementById("swiper-container");
        swiperContainer.classList.add("swiper-container-animate-in");
      });
    </script>
  </body>
</html>
